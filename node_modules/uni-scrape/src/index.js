'use strict';

// Scrape a linkedin profile for the public contents
import Promise from 'bluebird';
import window from './util/window';
import parseBuilder from './parser/index';

function parse(lodaded, parser) {
  return new Promise((resolve, reject) => {
    try {
      const $ = lodaded.$;
      const result = parser($);
      resolve(result);
    } catch (err) {
      reject(err);
    }
  });
}

export default function build(template) {
  const parser = parseBuilder(template);
  return (html) => window.load(html).then(lodaded => parse(lodaded, parser));
}
